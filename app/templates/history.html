{% extends "base.html" %}

{% block title %}Histórico de Análises{% endblock %}

{% block content %}
<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
    <h1 class="h2">Histórico de Análises</h1>
</div>

<div class="table-responsive">
    <table class="table table-striped table-hover">
        <thead>
            <tr>
                <th scope="col">#</th>
                <th scope="col">Identificador</th>
                <th scope="col">Tipo</th>
                <th scope="col">Veredito</th>
                <th scope="col">Data</th>
                <th scope="col">Ações</th>
            </tr>
        </thead>
        <tbody>
            {% for analysis in analyses %}
            <tr>
                <td>{{ loop.index }}</td>
                <td class="text-truncate" style="max-width: 300px;">{{ analysis.item_identifier }}</td>
                <td><span class="badge bg-secondary">{{ analysis.item_type }}</span></td>
                <td>
                    <span class="badge 
                        {% if analysis.final_verdict == 'malicious' %}bg-danger
                        {% elif analysis.final_verdict == 'suspicious' %}bg-warning text-dark
                        {% else %}bg-success{% endif %}">
                        {{ analysis.final_verdict | capitalize }}
                    </span>
                </td>
                <td>{{ analysis.created_at | int | strftime('%d/%m/%Y %H:%M') }}</td>
                <td>
                    <a href="{{ url_for('main.results', report_id=analysis.id) }}" class="btn btn-sm btn-primary">Ver Detalhes</a>
                </td>
            </tr>
            {% else %}
            <tr>
                <td colspan="6" class="text-center">Nenhuma análise encontrada no histórico.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}